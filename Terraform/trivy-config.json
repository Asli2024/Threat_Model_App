{
  "SchemaVersion": 2,
  "CreatedAt": "2025-10-30T18:44:36.162535Z",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 68,
        "Failures": 0
      }
    },
    {
      "Target": "../Terraform/Modules/Cloudfront/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0010",
          "AVDID": "AVD-AWS-0010",
          "Title": "Cloudfront distribution should have Access Logging configured",
          "Description": "You should configure CloudFront Access Logging to create log files that contain detailed information about every user request that CloudFront receives\n",
          "Message": "Distribution does not have logging enabled",
          "Namespace": "builtin.aws.cloudfront.aws0010",
          "Query": "data.builtin.aws.cloudfront.aws0010.deny",
          "Resolution": "Enable logging for CloudFront distributions",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0010",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.cloudfront",
            "Provider": "AWS",
            "Service": "cloudfront",
            "StartLine": 16,
            "EndLine": 62,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_cloudfront_distribution\" \"this\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudfront_distribution\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  enabled         = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menabled\u001b[0m         = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  is_ipv6_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mis_ipv6_enabled\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  comment         = \"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcomment\u001b[0m         = \u001b[38;5;37m\"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  aliases         = var.aliases",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245maliases\u001b[0m         = \u001b[38;5;33mvar\u001b[0m.aliases",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  price_class     = var.price_class",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mprice_class\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.price_class",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  origin {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  origin {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    domain_name = var.domain_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mdomain_name\u001b[0m = \u001b[38;5;33mvar\u001b[0m.domain_name",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.cloudfront",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 231,
                  "EndLine": 238
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0011",
          "AVDID": "AVD-AWS-0011",
          "Title": "CloudFront distribution does not have a WAF in front.",
          "Description": "You should configure a Web Application Firewall in front of your CloudFront distribution. This will mitigate many types of attacks on your web application.\n",
          "Message": "Distribution does not utilise a WAF.",
          "Namespace": "builtin.aws.cloudfront.aws0011",
          "Query": "data.builtin.aws.cloudfront.aws0011.deny",
          "Resolution": "Enable WAF for the CloudFront distribution",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0011",
          "References": [
            "https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0011"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.cloudfront",
            "Provider": "AWS",
            "Service": "cloudfront",
            "StartLine": 16,
            "EndLine": 62,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_cloudfront_distribution\" \"this\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudfront_distribution\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  enabled         = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menabled\u001b[0m         = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  is_ipv6_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mis_ipv6_enabled\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  comment         = \"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcomment\u001b[0m         = \u001b[38;5;37m\"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  aliases         = var.aliases",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245maliases\u001b[0m         = \u001b[38;5;33mvar\u001b[0m.aliases",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  price_class     = var.price_class",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mprice_class\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.price_class",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  origin {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  origin {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    domain_name = var.domain_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mdomain_name\u001b[0m = \u001b[38;5;33mvar\u001b[0m.domain_name",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.cloudfront",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 231,
                  "EndLine": 238
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "../Terraform/Modules/Security_Groups/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.alb_sg",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 27,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group\" \"this\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "      cidr_blocks      = lookup(egress.value, \"cidr_blocks\", null)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mcidr_blocks\u001b[0m      =\u001b[38;5;33m lookup\u001b[0m(egress.value, \u001b[38;5;37m\"cidr_blocks\"\u001b[0m, null)",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 32,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "content",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 22,
                  "EndLine": 31
                }
              },
              {
                "Resource": "dynamic.egress",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 20,
                  "EndLine": 32
                }
              },
              {
                "Resource": "aws_security_group.this",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 33
                }
              },
              {
                "Resource": "module.alb_sg",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 136,
                  "EndLine": 165
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"this\" {\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {\n  egress {\n    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n  }\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.application_sg",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 27,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group\" \"this\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "      cidr_blocks      = lookup(egress.value, \"cidr_blocks\", null)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mcidr_blocks\u001b[0m      =\u001b[38;5;33m lookup\u001b[0m(egress.value, \u001b[38;5;37m\"cidr_blocks\"\u001b[0m, null)",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 32,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "content",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 22,
                  "EndLine": 31
                }
              },
              {
                "Resource": "dynamic.egress",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 20,
                  "EndLine": 32
                }
              },
              {
                "Resource": "aws_security_group.this",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 33
                }
              },
              {
                "Resource": "module.application_sg",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 167,
                  "EndLine": 197
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"this\" {\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {\n  egress {\n    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n  }\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.vpce_sg",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 27,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group\" \"this\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "      cidr_blocks      = lookup(egress.value, \"cidr_blocks\", null)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mcidr_blocks\u001b[0m      =\u001b[38;5;33m lookup\u001b[0m(egress.value, \u001b[38;5;37m\"cidr_blocks\"\u001b[0m, null)",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 32,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "content",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 22,
                  "EndLine": 31
                }
              },
              {
                "Resource": "dynamic.egress",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 20,
                  "EndLine": 32
                }
              },
              {
                "Resource": "aws_security_group.this",
                "Filename": "../Terraform/Modules/Security_Groups/main.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 33
                }
              },
              {
                "Resource": "module.vpce_sg",
                "Filename": "main.tf",
                "Location": {
                  "StartLine": 105,
                  "EndLine": 134
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group\" \"this\" {\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {\n  egress {\n    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n  }\n}"
            }
          }
        }
      ]
    },
    {
      "Target": "Modules/ACM",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/ALB",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 42,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/Cloudfront",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 40,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/Cloudfront/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0010",
          "AVDID": "AVD-AWS-0010",
          "Title": "Cloudfront distribution should have Access Logging configured",
          "Description": "You should configure CloudFront Access Logging to create log files that contain detailed information about every user request that CloudFront receives\n",
          "Message": "Distribution does not have logging enabled",
          "Namespace": "builtin.aws.cloudfront.aws0010",
          "Query": "data.builtin.aws.cloudfront.aws0010.deny",
          "Resolution": "Enable logging for CloudFront distributions",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0010",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0010"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_cloudfront_distribution.this",
            "Provider": "AWS",
            "Service": "cloudfront",
            "StartLine": 16,
            "EndLine": 62,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_cloudfront_distribution\" \"this\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudfront_distribution\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  enabled         = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menabled\u001b[0m         = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  is_ipv6_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mis_ipv6_enabled\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  comment         = \"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcomment\u001b[0m         = \u001b[38;5;37m\"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  aliases         = var.aliases",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245maliases\u001b[0m         = \u001b[38;5;33mvar\u001b[0m.aliases",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  price_class     = var.price_class",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mprice_class\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.price_class",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  origin {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  origin {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    domain_name = var.domain_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mdomain_name\u001b[0m = \u001b[38;5;33mvar\u001b[0m.domain_name",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0011",
          "AVDID": "AVD-AWS-0011",
          "Title": "CloudFront distribution does not have a WAF in front.",
          "Description": "You should configure a Web Application Firewall in front of your CloudFront distribution. This will mitigate many types of attacks on your web application.\n",
          "Message": "Distribution does not utilise a WAF.",
          "Namespace": "builtin.aws.cloudfront.aws0011",
          "Query": "data.builtin.aws.cloudfront.aws0011.deny",
          "Resolution": "Enable WAF for the CloudFront distribution",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0011",
          "References": [
            "https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0011"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_cloudfront_distribution.this",
            "Provider": "AWS",
            "Service": "cloudfront",
            "StartLine": 16,
            "EndLine": 62,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_cloudfront_distribution\" \"this\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudfront_distribution\"\u001b[0m \u001b[38;5;37m\"this\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  enabled         = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menabled\u001b[0m         = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  is_ipv6_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mis_ipv6_enabled\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  comment         = \"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcomment\u001b[0m         = \u001b[38;5;37m\"Threat Composer App CloudFront (VPC origin -\u003e ALB)\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  aliases         = var.aliases",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245maliases\u001b[0m         = \u001b[38;5;33mvar\u001b[0m.aliases",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  price_class     = var.price_class",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mprice_class\u001b[0m     = \u001b[38;5;33mvar\u001b[0m.price_class",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  origin {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  origin {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    domain_name = var.domain_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mdomain_name\u001b[0m = \u001b[38;5;33mvar\u001b[0m.domain_name",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "Modules/ECS",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 43,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/Gateway_Endpoint",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/IAM",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/Interface_Endpoint",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/Route53",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/Security_Groups",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 58,
        "Failures": 0
      }
    },
    {
      "Target": "Modules/VPC",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 60,
        "Failures": 0
      }
    }
  ]
}
